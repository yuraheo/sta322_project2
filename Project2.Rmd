```{r}
# Define factor levels
rotor_length <- c("7.5 cm", "8.5 cm")
leg_length   <- c("7.5 cm", "12.0 cm")
leg_width    <- c("3.2 cm", "5.0 cm")
paper_clip   <- c("No", "Yes")

# Create full 2^4 factorial design
base_design <- expand.grid(
  RotorLength = rotor_length,
  LegLength   = leg_length,
  LegWidth    = leg_width,
  PaperClip   = paper_clip
)

# Add 4 replicates per combination
design <- base_design[rep(1:nrow(base_design), each = 4), ]

# Add replicate number
design$Replicate <- rep(1:4, times = nrow(base_design))

# Add empty column for flight time
design$FlightTime_sec <- NA

# Save CSV
#write.csv(design, "helicopter_design.csv", row.names = FALSE)

#design

```


```{r}
library(tidyverse)
library(emmeans)
heli <- read_csv("helicopter_design.csv")

glimpse(heli)
heli <- heli %>%
  mutate(
    rotor    = factor(RotorLength),
    leg_len  = factor(LegLength),
    leg_width= factor(LegWidth),
    clip     = factor(PaperClip)
  )

# fit full factorial
fit_full <- lm(
  FlightTime_sec ~ rotor * leg_len * leg_width * clip,
  data = heli
)
summary(fit_full)
confint(fit_full)
```

# Q1. Which factors are most important to make helicopters that fly longer?

The model results indicate that leg length and paperclip use are the most important factors influencing helicopter flight duration. The effect of increasing leg length (from 7.5cm to 12.0cm) is estimated to decrease flight time by 0.26 seconds (SE = 0.0587). With the 95% confidence interval being entirely below zero, this shows strong evidence that longer legs reduce flight time, making shorter legs the better design. 

# Q2. Is there any evidence that the effect of rotor length differs by leg width?
```{r}
# test rotor:leg_width interaction
summary(fit_main2)
# rotor effect within each leg width level 
emm_rw <- emmeans(fit_main2, ~ rotor | leg_width)
emm_rw
contrast(emm_rw, "revpairwise")  # rotor_high - rotor_low at each leg_width
# If the differences (and/or interaction p-value) are large and significant,
# that’s evidence that rotor effect depends on leg width.
```



# Q3: What would you recommend as the ideal combination to make the helicopter fly long?
Even though statististical differences are not significant, we can still identify the best performing condition by examining the predicted flight times from the full model. The conditions producing the highest predicted flight time were those with: 
* Longer legs (12 cm)  
* Wider legs (5.0 cm)
* A paperclip attached
* Longer rotor length (8.5 cm)



# Model Justification and Diagnostics
```{r}
par(mfrow = c(1, 2))
plot(fit_full, which = 1)  # Residuals vs fitted (check linearity + constant variance)
plot(fit_full, which = 2)  # Normal Q–Q plot of residuals

par(mfrow = c(1, 1))
```
For this experiment, we chose a full factorial design consisting of four factors: roter length(2 levels), leg length(2 levels), leg width(2 levels), paperclip(2 levels). Because the project asks the best combination and interaction effects, a full factorial model makes it the most accurate as it produces predicted means for all 16 combinations.   
The residuals appear randomly scattered around zeros across the entire range and there is no clear curvature or funneling pattern suggesting there is no evidence of missing nonlinear structure. Homoscedasticity holds reasonably well as the vertical spread of residuals is roughly constant across fitted values.  
The QQ plot shows that the normality assumption is largely satisfied as it follows the 45 degree line.  

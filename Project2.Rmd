---
title: "Project 2"
author: "Yura Heo, Kathleen Zhang"
format: pdf
editor: visual
---

```{r}
# Define factor levels
rotor_length <- c("7.5 cm", "8.5 cm")
leg_length   <- c("7.5 cm", "12.0 cm")
leg_width    <- c("3.2 cm", "5.0 cm")
paper_clip   <- c("No", "Yes")

# Create full 2^4 factorial design
base_design <- expand.grid(
  RotorLength = rotor_length,
  LegLength   = leg_length,
  LegWidth    = leg_width,
  PaperClip   = paper_clip
)

# Add 4 replicates per combination
design <- base_design[rep(1:nrow(base_design), each = 4), ]

# Add replicate number
design$Replicate <- rep(1:4, times = nrow(base_design))

# Add empty column for flight time
design$FlightTime_sec <- NA

# Save CSV
#write.csv(design, "helicopter_design.csv", row.names = FALSE)

#design

```

```{r}
library(tidyverse)
library(emmeans)
heli <- read_csv("helicopter_design.csv")

glimpse(heli)
heli <- heli %>%
  mutate(
    rotor    = factor(RotorLength),
    leg_len  = factor(LegLength),
    leg_width= factor(LegWidth),
    clip     = factor(PaperClip)
  )

# fit full factorial
fit_full <- lm(
  FlightTime_sec ~ rotor * leg_len * leg_width * clip,
  data = heli
)
summary(fit_full)
confint(fit_full)
```

# Q1. Which factors are most important to make helicopters that fly longer?

The model results indicate that leg length and paperclip use are the most important factors influencing helicopter flight duration. The effect of increasing leg length (from 7.5cm to 12.0cm) is estimated to decrease flight time by 0.26 seconds (SE = 0.0587). With the 95% confidence interval being entirely below zero, this shows strong evidence that longer legs reduce flight time, making shorter legs the better design.

# Q2. Is there any evidence that the effect of rotor length differs by leg width?

The analysis of our full factorial design shows that the `rotor:leg_width` interaction is not statistically significant (p = 0.43), meaning the interaction does not meaningfully improve the model. The point estimate for the `rotor:leg_width` interaction is -0.18 seconds, meaning that the difference in flight time between the 8.5 and 7.5 cm rotors is approximately 0.18 seconds shorter when the legs are 5 cm wide than when the legs are 3.2 cm wide. Because our 95% confidence interval is (-0.64, 0.28) and includes 0, there is insufficient statistical evidence to conclude that the effect of rotor length depends on leg width.

# Q3: What would you recommend as the ideal combination to make the helicopter fly long?

```{r}
library(emmeans)

fit_full <- lm(FlightTime_sec ~ rotor * leg_len * leg_width * clip, data = heli)

emm_all  <- emmeans(fit_full, ~ rotor * leg_len * leg_width * clip)
emm_tbl  <- summary(emm_all)   

best_row <- emm_tbl[which.max(emm_tbl$emmean), ]
best_row


```

Even though statistical differences are not significant, we can still identify the best-performing conditions to find an optimal helicopter design by examining the predicted flight times from the full factorial. We estimated the model-based mean flight times from the `emmeans` output and identified the combination with the largest predicted mean flight time. The longest predicted mean flight time is about 2.44 seconds (with a 95% confidence interval of (2.21, 2.67)) for a helicopter with a rotor of 8.5 cm (longer rotor/high setting), leg length of 7.5 cm (shorter leg length/low setting), leg width of 5.0 cm (longer leg width/high setting), and no paper clip attached (low setting). Therefore, the ideal combination to make the helicopter fly long is a rotor of 8.5 cm, leg length of 7.5 cm, leg width of 5.0 cm, and no paper clip attached.

# Diagnostics

```{r}
par(mfrow = c(1, 2))
plot(fit_main2, which = 1)  # Residuals vs fitted (check linearity + constant variance)
plot(fit_main2, which = 2)  # Normal Qâ€“Q plot of residuals

par(mfrow = c(1, 1))
```
